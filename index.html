<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CodeStore by NL - Free HTML, PHP, DSC++ Code Experiments & Tutorials</title>
  <meta name="description" content="Access 40+ free coding experiments in HTML, PHP, and DSC++ (Data Structures C++). Download code, view outputs, and learn programming through practical examples. Perfect for students and developers." />
  <meta name="keywords" content="HTML code examples, PHP tutorials, DSC++ programs, data structures C++, free code download, programming experiments, coding for students, computer science projects, code repository, Nathan Lobo" />
  <meta name="author" content="Nathan Lobo" />
  <link rel="canonical" href="https://nathanlobo.github.io/" />
  <link rel="icon" type="image/x-icon" href="./assets/icon.webp">
  <!-- Open Graph Meta Tags for Social Sharing -->
  <meta property="og:title" content="CodeStore - Free Code Experiments for HTML, PHP & DSC++" />
  <meta property="og:description" content="OneStop CodeStore - Browse & download 40+ code experiments for HTML, PHP, & DSC++. Free educational resources for students." />
  <meta property="og:image" content="https://nathanlobo.github.io/assets/icon.png" />
  <meta property="og:url" content="https://nathanlobo.github.io/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="CodeStore by NL" />
  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="CodeStore - Free Code Experiments" />
  <meta name="twitter:description" content="Access 40+ free coding experiments in HTML, PHP, & DSC++. Download code and learn programming." />
  <meta name="twitter:image" content="https://nathanlobo.github.io/assets/icon.png" />
  <!-- Structured Data for SEO -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "CodeStore",
    "url": "https://nathanlobo.github.io/",
    "description": "Free code experiments and tutorials for HTML, PHP, and DSC++",
    "author": {
      "@type": "Person",
      "name": "Nathan Lobo",
      "url": "https://github.com/nathanlobo"
    },
    "inLanguage": "en",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://nathanlobo.github.io/?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>
  <style>
  :root {
    --bg: #0d1117;
    --panel: #0d1117;
    --muted: #8b949e;
    --border: #30363d;
    --accent: #74b5ff;
    --text: #c9d1d9;
    --warning:yellow;
  }
  :root.light {
    --bg: #ffffff;
    --panel: #f6f8fa;
    --muted: #57606a;
    --border: #d0d7de;
    --accent: #0969da;
    --text: #24292f;
    --warning:#ffcc00;
  }
  body { 
    font-family: Arial, Helvetica, sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    display: flex;
    flex-direction: column; 
    padding: 8px;
  }
  /* CSS for Pop up to ask for name */
  .modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place, even on scroll */
    z-index: 1000; /* Sit on top of everything */
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5); /* Black with 50% opacity */
  }

  /* The modal's content box */
  .modal-content {
    background-color: var(--bg);
    /* Center the modal */
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    
    /* More comfortable padding and box sizing */
    padding: 16px 18px;
    border: 1px solid var(--text);
    width: 88%;
    max-width: 450px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    text-align: center;
  }
  .modal-content p {
    line-height: 1.2;
    font-size: 17px;
    margin: 0 0 8px 0;
  }
  .modal-content i {
    font-size: 15px;
    color: var(--warning);
    display: block;
    margin-bottom: 10px;
    letter-spacing: 0.5px;
  }
  .modal-content form {
    margin-top: 15px;
  }
  .modal-content input[type="text"] {
    width: 100%;
    padding: 12px;
    border: 1px solid var(--border);
    border-radius: 6px;
    background: var(--bg);
    color: var(--text);
    font-size: 15px;
    box-sizing: border-box;
    margin-bottom: 8px;
  }
  .modal-content input[type="text"]:focus {
    outline: none;
    border-color: var(--accent);
  }
  .btnGrp {
    display: flex;
    gap: 10px;
    margin-top: 15px;
    justify-content: center;
  }
  .btnGrp button,
  .btnGrp input[type="button"] {
    padding: 10px 24px;
    border: none;
    border-radius: 6px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
  }
  .btnGrp button[type="submit"] {
    background: var(--accent);
    color: white;
  }
  .btnGrp button[type="submit"]:hover {
    background: #5a9eeb;
    transform: translateY(-1px);
  }
  
  /* Donate Modal specific styles */
  .close-donate {
    position: absolute;
    top: 5px;
    right: 8px;
    font-size: 14px;
    font-weight: bold;
    cursor: pointer;
    color: var(--text);
    opacity: 0.4;
    transition: opacity 0.2s;
  }
  .close-donate:hover {
    opacity: 1;
  }
  #donateBtn {
    background: #FFD700; /* Gold color for donate button */
    color: #000;
    width: 100%;
    margin-top: 10px;
  }
  #donateBtn:hover {
    background: #FFC800;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  }
  .btnGrp input[type="button"] {
    background: transparent;
    color: var(--muted);
    border: 1px solid var(--border);
  }
  .btnGrp input[type="button"]:hover {
    background: var(--panel);
    color: var(--text);
  }

.header-container {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.logo-link {
  display: flex;
  align-items: center;
  text-decoration: none;
  color: inherit;
  flex-shrink: 0;
}

.logo-icon {
  height: 40px;
}

.logo-text {
  margin-left: 12px;
  font-size: 20px;
  font-weight: 700;
  margin-top: 0;
  margin-bottom: 0;
}

.logo-text-container {
  margin-left: 12px;
}

.rebrand-text {
  font-size: 0.7em;
  font-weight: normal;
}

hr{
  display: none;
}

.status-text {
  text-align: right;
  color: var(--warning);
  margin-top: 4px;
  margin-bottom: 0;
  font-size: 16px;
  letter-spacing: .8px;
}

@media (max-width: 620px) {
  .header-container {
    flex-direction: column; 
    align-items: flex-start; 
  }
  .rebrand-text {
    display: block;
    margin-top: 4px;
  }
  .logo-text-container {
    margin-left: 0;
  }
  .status-text {
    text-align: left;
    letter-spacing: 0;
  }
  .footer-bar {
    padding: 12px 8px;
  }
  .footer-content {
    gap: 8px;
  }
  .social-links {
    gap: 20px;
  }
  .social-icon {
    width: 36px;
    height: 36px;
  }
  .footer-title {
    font-size: 12px;
    letter-spacing: 1.5px;
    word-spacing: 3px;
  }
  .footer-text {
    font-size: 11px;
    text-align: center;
    line-height: 1.5;
  }
  hr {
    display: block;
    border: none; /* Remove default border */
    border-top: 2px solid var(--border); /* Add a custom top border */
    width: 100%; /* Adjust width */
    margin: 10px auto; /* Center the line and add spacing */
  }
}

  .topbar {
    top: 0; /* Stops the top bar from going beyond top out of screen */
    margin-top: 5px;
    position: sticky;
    display:flex; 
    align-items:center;
    padding:2px 10px;
    border-bottom:1.8px solid var(--border);
    background:var(--panel);
    z-index: 999;
    border-radius: 0 0 8px 8px;
    gap: 10px;
  }
  
  /* Navigation Menu Styles */
  .nav-menu {
    display: flex;
    gap: 5px;
    align-items: center;
    margin-left: auto;
    margin-right: 10px;
  }
  .nav-link {
    background: transparent;
    border: 1px solid transparent;
    color: var(--muted);
    padding: 6px 12px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 600;
    font-size: 14px;
    text-decoration: none;
    transition: all 0.2s;
    white-space: nowrap;
  }
  .nav-link:hover {
    background: rgba(88,166,255,0.1);
    color: var(--accent);
  }
  @media (max-width: 768px) {
    .nav-menu {
      display: none; /* Hide on mobile to avoid clutter */
    }
  }
  
  .btn {
    background:transparent;
    border:1px solid transparent;
    color:var(--muted);
    padding:6px 10px;
    border-radius:6px;
    cursor:pointer; font-weight:700;
  }
  .btn:hover { background-color: #0b64ffab; }

  /* Footer Styles */
  .footer-bar {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: var(--panel);
    border-top: 1px solid var(--border);
    padding: 6px 8px;
    z-index: 1000;
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
  }
  .footer-content {
    max-width: 900px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
  }
  .social-links {
    display: flex;
    gap: 24px;
    align-items: center;
  }
  .social-icon {
    color: var(--muted);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
  }
  .social-icon:hover {
    color: var(--accent);
    background: rgba(116, 181, 255, 0.1);
    transform: translateY(-2px);
  }
  :root{--speed: .1}
  
  #whatsapp {
    transition: color .3 ease-in-out, transform .4 ease-in-out; /* Define transition for background-color */
    transition-delay: .01s; /* Delay the start of the transition by 1 second */
  }
  #whatsapp.change-color { color: #25D366; }
  #whatsapp.transform { transform: translateY(-3px) scale(1.2); 
    /* transform: scale(1.1); */
  }

  #instagram {
    transition: color .3 ease-in-out, transform .3 ease-in-out; /* Define transition for background-color */
    transition-delay: .2s; /* Delay the start of the transition by 1 second */
  }
  #instagram.change-color { color: #db317e; }
  #instagram.transform { transform:translateY(-3px) scale(1.2);
     /* transform: scale(1.2); */
    }

  #gmail {
    transition: color .3 ease-in-out, transform .2 ease-in-out; /* Define transition for background-color */
    transition-delay: .3s; /* Delay the start of the transition by 1 second */
  }
  #gmail.change-color { color: #FF0000; }
  #gmail.transform { transform:translateY(-3px) scale(1.2); 
    /* transform: scale(1.2);  */
  }

  #github {
    transition: color .3 ease-in-out, transform .1 ease-in-out; /* Define transition for background-color */
    transition-delay: .4s; /* Delay the start of the transition by 1 second */
  }
  #github.change-color { color: #156eeb;}
  #github.transform{ transform: translateY(-3px) scale(1.2);
    /* transform: scale(1.2); */
  }

  .footer-text {
    margin: 0;
    font-size: 12px;
    color: var(--muted);
  }
  .footer-text.change{
    color: var(--text);
  }
  .footer-links {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 2px;
  }
  .footer-link {
    color: var(--accent);
    text-decoration: none;
    font-size: 12px;
    transition: opacity 0.2s;
  }
  .footer-link:hover {
    opacity: 0.8;
    text-decoration: underline;
  }
  .footer-separator {
    color: var(--muted);
    font-size: 12px;
  }
  .footer-title {
    margin: 0;
    font-size: 12px;
    letter-spacing: 1.5px;
    word-spacing: 3px;
    font-weight: 700;
    color: var(--muted);
  }
  .footer-title.change{
    color: var(--text);
  }
  /* Add padding to body to prevent content from being hidden behind footer */
  body::after {
    content: '';
    display: block;
    height: 100px;
  }
  /* Simplified layout (ads removed) */
  .main-content-wrapper {
    max-width: 900px;
    margin: 0 auto;
  }
  .center-content { max-width: 900px; margin: 0 auto; }
  .link-container {
    display:flex;
    flex-direction:column;
    gap:15px;
    max-width:900px;
    margin:auto;
    margin-top:16px; }
  .link-block {
    background:#161d80;
    color:white;
    padding:12px 16px;
    border-radius: 8px;
    display: block; }
  .link-info {
    display:flex;
    flex-direction:column;
    gap:4px;
    overflow:hidden;
    max-width:100%; }
  .link-title {
    font-weight:700;
    font-size:15px;}
  .link-url { 
        font-size:15px; 
        color:rgba(255,255,255,0.95); 
        overflow:initial; 
        text-overflow:initial; 
        white-space:normal; /* Allows text to wrap */
        display:block;
        width: 100%;
        text-decoration: none;
        line-height: 1.5;
    }
    /* NEW CLASS: Used in JS to align content and buttons */
    .file-row { 
        display: flex; 
        flex-wrap: wrap; 
        justify-content: space-between; 
        align-items: center; 
        width: 100%; 
        margin-top: 4px;
        gap: 8px; 
    }
    /* MODIFIED: Added flex-shrink: 0 to prevent buttons from shrinking */
    .button-container { display:flex; gap:8px; flex-shrink:0; }
    .btn { padding:8px 12px; border-radius:5px; border:none; cursor:pointer; font-weight:700; }
    .btn-view, .btn-output, .btn-download { background:#0b66ff; color:white; }
    /* responsive */
    @media (max-width:620px){
      .link-block { flex-direction:column; align-items:flex-start; }
      .button-container { width:100%; justify-content:flex-end; }
      .link-info { max-width:100%; }
    }
    
    /* Tab Navigation Styles */
    .tabs-nav {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    .tab-btn {
      background: none;
      border: none;
      color: var(--muted);
      font-weight: 700;
      font-size: 16px;
      padding: 6px 18px;
      border-radius: 6px 6px 0 0;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
      margin-bottom: -1px;
      border-bottom: 2px solid transparent;
    }
    .tab-btn.active, .tab-btn:hover {
      color: var(--accent);
      background: var(--bg);
      border-bottom: 2px solid var(--accent);
    }
    /* Toggle Switch Styles from toggle.html */
    .theme-switch-wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 4px 8px;
      border-radius: 5px;
      font-size: 12px;
      gap: 2px;
    }
    #mode-text {
      margin-bottom: 2px;
      font-weight: bold;
      font-size: 12px;
    }
    .theme-switch {
      position: relative;
      display: inline-block;
      width: 36px;
      height: 20px;
    }
    .theme-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: 0.4s;
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 14px;
      width: 14px;
      left: 3px;
      bottom: 3px;
      background-color: #fff;
      transition: 0.4s;
    }
    input:checked + .slider {
      background-color: #66bb6a;
    }
    input:checked + .slider:before {
      transform: translateX(16px);
    }
    .slider.round {
      border-radius: 20px;
    }
    .slider.round:before {
      border-radius: 50%;
    }
    
    /* Version Selector Dropdown Styles */
    .version-dropdown {
      display: none;
      position: absolute;
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 8px 0;
      z-index: 1000;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      min-width: 160px;
      margin-top: 4px;
    }
    
    .version-dropdown.show {
      display: block;
    }
    
    .version-option {
      padding: 10px 16px;
      cursor: pointer;
      color: var(--text);
      transition: background 0.2s;
      font-size: 14px;
      font-weight: 500;
    }
    
    .version-option:hover {
      background: rgba(88, 166, 255, 0.1);
      color: var(--accent);
    }
    
    /* Loading Spinner Styles */
    #loadingOverlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--bg);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.5s ease-out;
    }
    
    #loadingOverlay.hidden {
      opacity: 0;
      pointer-events: none;
    }
    
    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid var(--border);
      border-top: 4px solid var(--accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .loading-text {
      margin-top: 20px;
      color: var(--text);
      font-size: 16px;
      font-weight: 600;
    }
    
  </style>
</head>
<body>
  <!-- Loading Overlay -->
  <div id="loadingOverlay">
      <div class="spinner"></div>
      <div class="loading-text">Loading CodeStore...</div>
  </div>
  <div class="header-container">
    <a href="https://nathanlobo.github.io/" class="logo-link">
      <img src="assets/icon.webp" alt="CodeStore Logo" class="logo-icon">
      <div class="logo-text-container">
        <h1 class="logo-text">CodeStore <span class="rebrand-text">is rebranding to Codinx</span></h1>
      </div>
    </a>    
  </div>
  <div class="topbar">
    <div class="tabs-nav">
      <button class="tab-btn active" data-tab="HTML">HTML</button>
      <button class="tab-btn" data-tab="PHP">PHP</button>
      <button class="tab-btn" data-tab="DSC++">DSC++</button>
    </div>
    <nav class="nav-menu">
      <a href="about.html" class="nav-link">About</a>
      <a href="privacy-policy.html" class="nav-link">Privacy</a>
    </nav>
    <div class="theme-switch-wrapper">
      <span id="mode-text">Dark</span>
      <label class="theme-switch" for="checkbox">
        <input type="checkbox" id="checkbox" />
        <div class="slider round"></div>
      </label>
    </div>
  </div>
  <div id="rollNoModal" class="modal">
    <div class="modal-content">
      <p id="rollno-modal-text">Roll Number Required</p>
      <i id="rollno-modal-warning">Already Existing & Upcoming New features need your roll number</i>
      <form id="rollNoForm">
        <input type="text" id="rollNoInput" name="rollNoInput" placeholder="Enter your Roll No. (e.g. 25LEC07)" required>
        <div id="rollNoError" style="color: red; font-size: 14px; margin-top: 4px; display: none;"></div>
        <div class="btnGrp">
          <button type="submit">Submit</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Donate Modal -->
  <div id="donateModal" class="modal">
    <div class="modal-content" style="padding: 24px;">
      <span class="close-donate" id="closeDonate">&times;</span>
      <h2 style="margin-top: 0; color: var(--accent); font-size: 22px;">Support Us ‚ù§Ô∏è</h2>
      <p style="font-size: 16px; margin: 15px 0;">We hope you've found <b>CodeStore</b> aka Codinx helpful!</p>
      <p style="font-size: 14px; color: var(--muted); line-height: 1.4;">If this website has saved you time or effort,<br>Fund us <span style="color:var(--warning)">Even ‚Çπ1 Counts</span>. Every bit helps us keep the servers running and the experiments updated!</p>
      <div class="btnGrp">
        <button id="donateBtn">Support Us</button>
      </div>
    </div>
  </div>
  <div id="linkContainer" class="link-container">Loading...</div>
  <script>
    // Load data from JSON file
    let dscppExpts = [];
    let htmlExpts = [];
    let phpExpts = [];
    let zipDownloads = {};

    fetch('data.json')
      .then(response => response.json())
      .then(data => {
        dscppExpts = data.dscppExpts;
        htmlExpts = data.htmlExpts;
        phpExpts = data.phpExpts;
        zipDownloads = data.zipDownloads;
        
        // Initialize the page after data is loaded.
        // Ensure activateTab is defined by waiting until DOMContentLoaded if still parsing.
        const lastTab = localStorage.getItem('selectedTab') || 'HTML';
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', () => {
            if (typeof window.activateTab === 'function') {
              window.activateTab(lastTab);
            }
          }, { once: true });
        } else {
          if (typeof window.activateTab === 'function') {
            window.activateTab(lastTab);
          } else {
            // Fallback: schedule on next macrotask in case scripts are still evaluating
            setTimeout(() => {
              if (typeof window.activateTab === 'function') window.activateTab(lastTab);
            }, 0);
          }
        }
      })
      .catch(error => {
        console.error('Error loading data:', error);
        document.getElementById('linkContainer').innerHTML = '<p>Error loading experiments data. <b>Report on below contacts</p>';
      });
  </script>
  <script src="./index-script.js"></script>
  <script>
    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbw4BuUioqKHAZAV2SWzZUosyhmaARl_12PH_iDe1Y5l1-NCVoo2aitJkuajInx3--nj/exec';
    
    // Generate or retrieve a persistent deviceId (cookie + localStorage)
    function getDeviceId() {
      // Try localStorage first
      let id = localStorage.getItem('deviceId');
      if (id) return id;

      // Try cookie
      const match = document.cookie.match(/(?:^|;\s*)deviceId=([^;]+)/);
      if (match && match[1]) {
        id = match[1];
        localStorage.setItem('deviceId', id);
        return id;
      }

      // Create new cryptographically random ID
      const bytes = new Uint8Array(16);
      (window.crypto || window.msCrypto).getRandomValues(bytes);
      id = Array.from(bytes).map(b => b.toString(16).padStart(2, '0')).join('');

      // Persist to cookie (5 years) and localStorage
      document.cookie = `deviceId=${id}; path=/; max-age=${60*60*24*365*5}`;
      localStorage.setItem('deviceId', id);
      return id;
    }

    // Helper function to get stored user identifier (rollNo or userName)
    window.getStoredUserName = function() {
        return localStorage.getItem('rollNo') || localStorage.getItem('userName');
    };
    
    // Define sendAnalyticsData function first so it's available globally
    window.sendAnalyticsData = function(name, visitType, visitPage) {
        // If no name provided, try to get from storage
        if (!name) {
            name = getStoredUserName();
        }
        
        // Don't send if no user identifier is available
        if (!name) {
            console.log('Analytics not sent: No user identifier available');
            return;
        }
      // Always include deviceId as final column/param
      const deviceId = getDeviceId();
      const url = `${GOOGLE_SCRIPT_URL}?userName=${encodeURIComponent(name)}&visitType=${encodeURIComponent(visitType)}&visitPage=${encodeURIComponent(visitPage)}&deviceId=${encodeURIComponent(deviceId)}`;
        fetch(url, {
            method: 'POST',
            mode: 'no-cors' // Required for Google Apps Script
        })
        .then(() => {
            // Note: With 'no-cors' mode, we can't read the response
            // But the data is still sent successfully
            console.log(`Analytics data sent: ${name} - ${visitType}`);
        })
        .catch(error => {
            console.error('Error sending analytics data:', error);
        });
    };
    
    window.onload = async function() {
      const storedRollNo = localStorage.getItem('rollNo');
      const storedUserName = localStorage.getItem('userName');
      const currentTab = localStorage.getItem('selectedTab') || 'HTML';
      
      if (storedRollNo) {
        // Check if the stored roll number is the blocked one
        const normalizedStored = storedRollNo.trim().toUpperCase().replace(/\s+/g, '');
        if (normalizedStored === '25LEC07') {
          // Don't clear localStorage, but show modal to force them to enter correct roll number
          showBlockedRollNoModal(storedRollNo);
        } else {
          // Roll number exists and is valid
          sendAnalyticsData(null, 'Return Visit', currentTab);
          
          // Show donate modal for returning users after a short delay
          setTimeout(showDonateModal, 2000);
        }
      } else if (storedUserName) {
        // Username exists but no roll number - validate it
        const users = await loadPrefedUserData();
        const normalizedUserName = storedUserName.trim().toUpperCase().replace(/\s+/g, '');
        
        // Check if userName matches fname in prefedUser.json
        const matchedUser = users.find(user => {
          const fname = user.fname.trim().toUpperCase().replace(/\s+/g, '');
          return normalizedUserName === fname || normalizedUserName.includes(fname);
        });
        
        if (matchedUser) {
          // Valid username found - migrate to roll number
          localStorage.setItem('rollNo', matchedUser.roll_no);
          localStorage.removeItem('userName');
          // Send analytics for username to roll number migration
          sendAnalyticsData(matchedUser.roll_no, 'Username -> RN', storedUserName.trim());
        } else {
          // Invalid username - show modal with error
          showInvalidUserNameModal(storedUserName);
        }
      } else {
        // No username or roll number - show modal for first time users
        showRollNoModalForFirstTime();
      }
    };
    
    // Show modal for users with blocked roll number (25LEC07)
    function showBlockedRollNoModal(blockedRollNo) {
      const modal = document.getElementById('rollNoModal');
      const modalText = document.getElementById('rollno-modal-text');
      const modalWarning = document.getElementById('rollno-modal-warning');
      const input = document.getElementById('rollNoInput');
      const error = document.getElementById('rollNoError');
      const form = document.getElementById('rollNoForm');
      
      // Update modal text to show blocked message
      modalText.textContent = 'Invalid Roll Number';
      modalWarning.textContent = 'IP detected, you are not 25lec07, please enter your correct roll number.';
      modalWarning.style.color = 'var(--warning)';
      
      // Reset input and show modal
      input.value = '';
      error.style.display = 'none';
      modal.style.display = 'block';
      input.focus();
      
      // Real-time validation
      const inputHandler = async (e) => {
        const rollNo = e.target.value.trim();
        if (rollNo.length >= 5) {
          const user = await validateRollNo(rollNo);
          if (!user) {
            error.textContent = 'Invalid roll number! Roll number not found in database. Contact Developer';
            error.style.display = 'block';
          } else if (user.blocked) {
            error.textContent = user.message;
            error.style.display = 'block';
          } else {
            error.style.display = 'none';
          }
        } else {
          error.style.display = 'none';
        }
      };
      
      // Handle submission
      const submitHandler = async (e) => {
        e.preventDefault();
        const rollNo = input.value.trim();
        
        if (!rollNo) {
          error.textContent = 'Please enter your roll number';
          error.style.display = 'block';
          return;
        }
        
        const user = await validateRollNo(rollNo);
        
        if (user && user.blocked) {
          // Still trying to use blocked roll number
          error.textContent = user.message;
          error.style.display = 'block';
        } else if (user) {
          // Valid roll number - update localStorage and send analytics
          localStorage.setItem('rollNo', user.roll_no);
          
          // Send analytics: 25LEC07 user entered a new roll number
          sendAnalyticsData(user.roll_no, '25LEC07 Blocked -> New RN', blockedRollNo);
          
          // Close modal and clean up event listeners
          modal.style.display = 'none';
          input.removeEventListener('input', inputHandler);
          form.removeEventListener('submit', submitHandler);
          
          // Reload page after a short delay to ensure analytics is sent
          setTimeout(() => {
            location.reload();
          }, 500);
        } else {
          error.textContent = 'Invalid roll number! Roll number not found in database. Contact Developer';
          error.style.display = 'block';
        }
      };
      
      input.addEventListener('input', inputHandler);
      form.addEventListener('submit', submitHandler);
    }
    
    // Show modal for users with invalid usernames
    function showInvalidUserNameModal(invalidUserName) {
      const modal = document.getElementById('rollNoModal');
      const modalText = document.getElementById('rollno-modal-text');
      const modalWarning = document.getElementById('rollno-modal-warning');
      const input = document.getElementById('rollNoInput');
      const error = document.getElementById('rollNoError');
      const form = document.getElementById('rollNoForm');
      
      // Update modal text to show error
      modalText.textContent = 'Invalid Name Detected';
      modalWarning.textContent = `The name "${invalidUserName}" entered earlier is not valid. Please enter your roll number.`;
      modalWarning.style.color = 'var(--warning)';
      
      // Reset input and show modal
      input.value = '';
      error.style.display = 'none';
      modal.style.display = 'block';
      input.focus();
      
      // Real-time validation
      const inputHandler = async (e) => {
        const rollNo = e.target.value.trim();
        if (rollNo.length >= 5) {
          const user = await validateRollNo(rollNo);
          if (!user) {
            error.textContent = 'Invalid roll number! Roll number not found in database. Contact Developer';
            error.style.display = 'block';
          } else if (user.blocked) {
            error.textContent = user.message;
            error.style.display = 'block';
          } else {
            error.style.display = 'none';
          }
        } else {
          error.style.display = 'none';
        }
      };
      
      // Handle submission
      const submitHandler = async (e) => {
        e.preventDefault();
        const rollNo = input.value.trim();
        
        if (!rollNo) {
          error.textContent = 'Please enter your roll number';
          error.style.display = 'block';
          return;
        }
        
        const user = await validateRollNo(rollNo);
        
        if (user && user.blocked) {
          // Blocked roll number (25LEC07)
          error.textContent = user.message;
          error.style.display = 'block';
          // Track analytics: someone using 25LEC07 tried to enter it
          sendAnalyticsData('25LEC07-BLOCKED', 'RN Impersonator', rollNo);
        } else if (user) {
          // Valid roll number - update localStorage
          localStorage.setItem('rollNo', user.roll_no);
          localStorage.removeItem('userName');
          modal.style.display = 'none';
          
          // Send analytics with old invalid name
          sendAnalyticsData(user.roll_no, 'Valid RN Assigned', invalidUserName);
          
          // Clean up event listeners
          input.removeEventListener('input', inputHandler);
          form.removeEventListener('submit', submitHandler);

          // Show donate modal after some delay
          setTimeout(showDonateModal, 500);
        } else {
          error.textContent = 'Invalid roll number! Roll number not found in database. Contact Developer';
          error.style.display = 'block';
        }
      };
      
      input.addEventListener('input', inputHandler);
      form.addEventListener('submit', submitHandler);
    }
    
    // Show modal for first-time users (no localStorage data)
    function showRollNoModalForFirstTime() {
      const modal = document.getElementById('rollNoModal');
      const modalText = document.getElementById('rollno-modal-text');
      const modalWarning = document.getElementById('rollno-modal-warning');
      const input = document.getElementById('rollNoInput');
      const error = document.getElementById('rollNoError');
      const form = document.getElementById('rollNoForm');
      
      // Set default modal text
      modalText.textContent = 'Roll Number Required';
      modalWarning.textContent = 'Already Existing & Upcoming New features need your roll number';
      modalWarning.style.color = 'var(--warning)';
      
      // Reset and show modal
      input.value = '';
      error.style.display = 'none';
      modal.style.display = 'block';
      input.focus();
      
      // Real-time validation
      const inputHandler = async (e) => {
        const rollNo = e.target.value.trim();
        if (rollNo.length >= 5) {
          const user = await validateRollNo(rollNo);
          if (!user) {
            error.textContent = 'Invalid roll number! Roll number not found in database. Contact Developer';
            error.style.display = 'block';
          } else if (user.blocked) {
            error.textContent = user.message;
            error.style.display = 'block';
          } else {
            error.style.display = 'none';
          }
        } else {
          error.style.display = 'none';
        }
      };
      
      // Handle submission
      const submitHandler = async (e) => {
        e.preventDefault();
        const rollNo = input.value.trim();
        
        if (!rollNo) {
          error.textContent = 'Please enter your roll number';
          error.style.display = 'block';
          return;
        }
        
        const user = await validateRollNo(rollNo);
        
        if (user && user.blocked) {
          // Blocked roll number (25LEC07)
          error.textContent = user.message;
          error.style.display = 'block';
          // Track analytics: first-time user tried to use 25LEC07
          sendAnalyticsData('25LEC07-BLOCKED', 'RN Impersonator', rollNo);
        } else if (user) {
          // Valid roll number
          localStorage.setItem('rollNo', user.roll_no);
          modal.style.display = 'none';
          
          // Send analytics for first visit
          sendAnalyticsData(user.roll_no, 'First Visit', localStorage.getItem('selectedTab') || 'HTML');
          
          // Clean up event listeners
          input.removeEventListener('input', inputHandler);
          form.removeEventListener('submit', submitHandler);

          // Show donate modal after some delay for better experience
          setTimeout(showDonateModal, 500);
        } else {
          error.textContent = 'Invalid roll number! Roll number not found in database. Contact Developer';
          error.style.display = 'block';
        }
      };
      
      input.addEventListener('input', inputHandler);
      form.addEventListener('submit', submitHandler);
    }

    // Function to show the beautiful donate modal
    function showDonateModal() {
      const donateModal = document.getElementById('donateModal');
      const closeDonate = document.getElementById('closeDonate');
      const donateBtn = document.getElementById('donateBtn');
      
      if (!donateModal) return;

      donateModal.style.display = 'block';

      const closeHandler = () => {
        donateModal.style.display = 'none';
        closeDonate.removeEventListener('click', closeHandler);
        donateBtn.removeEventListener('click', donateHandler);
      };

      const donateHandler = () => {
        if (window.sendAnalyticsData) {
          sendAnalyticsData(null, 'Support Fund', '');
        }
        window.open('https://www.codinx.app/fund-me', '_blank');
        closeHandler();
      };

      closeDonate.addEventListener('click', closeHandler);
      donateBtn.addEventListener('click', donateHandler);
    }
    const owner = "nathanlobo";
    const repo = "CodeStore";
    const branch = "main";
    const container = document.getElementById('linkContainer');
    async function downloadFile(rawUrl, filename) {
      try {
        const res = await fetch(rawUrl);
        if (!res.ok) throw new Error(`https ${res.status}`);
        const blob = await res.blob();
        const blobUrl = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = blobUrl;
        a.download = filename || rawUrl.split('/').pop();
        a.style.display = 'none';
        document.body.appendChild(a);
        a.click();
        a.remove();
        setTimeout(() => URL.revokeObjectURL(blobUrl), 1500);
      } catch (err) {
        console.error('Download failed, opening raw URL instead:', err);
        window.open(rawUrl, '_blank');
      }
    }

    // Fetch prefedUser.json data
    let prefedUserData = null;
    async function loadPrefedUserData() {
      if (!prefedUserData) {
        try {
          const response = await fetch('prefedUser.json');
          const data = await response.json();
          prefedUserData = data['ecomp24-28'];
        } catch (error) {
          console.error('Error loading prefedUser.json:', error);
          prefedUserData = [];
        }
      }
      return prefedUserData;
    }

    // Validate roll number against prefedUser.json
    async function validateRollNo(rollNo) {
      const users = await loadPrefedUserData();
      const normalizedRollNo = rollNo.trim().toUpperCase().replace(/\s+/g, '');
      
      // Special check: Block 25LEC07 without NL suffix
      if (normalizedRollNo === '25LEC07') {
        return { blocked: true, message: 'IP detected, you are not 25LEC07, please enter correct roll no' };
      }
      
      return users.find(user => user.roll_no.trim().toUpperCase().replace(/\s+/g, '') === normalizedRollNo);
    }

    // Check and migrate userName to rollNo
    async function checkAndMigrateUserName() {
      const userName = localStorage.getItem('userName');
      if (!userName) return null;
      
      const users = await loadPrefedUserData();
      const normalizedUserName = userName.trim().toUpperCase().replace(/\s+/g, '');
      
      // Check if userName matches roll_no or fname (possibly with roll_no)
      const matchedUser = users.find(user => {
        const rollNo = user.roll_no.trim().toUpperCase().replace(/\s+/g, '');
        const fname = user.fname.trim().toUpperCase();
        
        // Check if userName is exactly roll_no
        if (normalizedUserName === rollNo) return true;
        
        // Check if userName contains roll_no or fname
        if (normalizedUserName.includes(rollNo) || normalizedUserName.includes(fname)) return true;
        
        return false;
      });
      
      if (matchedUser) {
        // Migrate to rollNo
        localStorage.removeItem('userName');
        localStorage.setItem('rollNo', matchedUser.roll_no);
        return matchedUser.roll_no;
      }
      
      return null;
    }

    // Show roll number modal and handle validation
    function showRollNoModal(outputUrl, filePath, exp, desc) {
      return new Promise((resolve, reject) => {
        const modal = document.getElementById('rollNoModal');
        const input = document.getElementById('rollNoInput');
        const error = document.getElementById('rollNoError');
        const form = document.getElementById('rollNoForm');
        
        // Reset state
        input.value = '';
        error.style.display = 'none';
        error.textContent = '';
        
        // Show modal
        modal.style.display = 'block';
        input.focus();
        
        // Real-time validation on input
        const inputHandler = async (e) => {
          const rollNo = e.target.value.trim();
          if (rollNo.length >= 5) { // Start validating after 5 characters
            const user = await validateRollNo(rollNo);
            if (!user) {
              error.textContent = 'Invalid roll number! Roll number not found in database. Contact Developer';
              error.style.display = 'block';
            } else if (user.blocked) {
              error.textContent = user.message;
              error.style.display = 'block';
            } else {
              error.style.display = 'none';
            }
          } else {
            error.style.display = 'none';
          }
        };
        
        // Handle form submission (Enter key or Submit button)
        const submitHandler = async (e) => {
          e.preventDefault();
          const rollNo = input.value.trim();
          
          if (!rollNo) {
            error.textContent = 'Please enter your roll number';
            error.style.display = 'block';
            return;
          }
          
          const user = await validateRollNo(rollNo);
          
          if (user && user.blocked) {
            // Blocked roll number (25LEC07)
            error.textContent = user.message;
            error.style.display = 'block';
            // Track analytics: someone tried to use 25LEC07 for DSC++ output
            sendAnalyticsData('25LEC07-BLOCKED', 'RN Impersonator', rollNo);
          } else if (user) {
            // Valid roll number
            localStorage.setItem('rollNo', user.roll_no);
            modal.style.display = 'none';
            
            // Clean up event listeners
            input.removeEventListener('input', inputHandler);
            form.removeEventListener('submit', submitHandler);
            modal.removeEventListener('click', closeHandler);
            
            // Resolve with the roll number
            resolve(user.roll_no);

            // Show donate modal after some delay
            setTimeout(showDonateModal, 500);
          } else {
            error.textContent = 'Invalid roll number! Roll number not found in database. Contact Developer';
            error.style.display = 'block';
          }
        };
        
        input.addEventListener('input', inputHandler);
        form.addEventListener('submit', submitHandler);
        
        // Handle modal close (if user clicks outside or closes)
        const closeHandler = (e) => {
          if (e.target === modal) {
            modal.style.display = 'none';
            input.removeEventListener('input', inputHandler);
            form.removeEventListener('submit', submitHandler);
            modal.removeEventListener('click', closeHandler);
            reject('Modal closed');
          }
        };
        
        modal.addEventListener('click', closeHandler);
      });
    }

    // Version Selector Function for Expt 7
    function showVersionSelector(button, action, filePath, exp, desc, idx, fileIdx) {
      // Remove any existing dropdowns
      document.querySelectorAll('.version-dropdown').forEach(d => d.remove());
      
      // Create dropdown
      const dropdown = document.createElement('div');
      dropdown.className = 'version-dropdown show';
      
      // Create options
      const originalOption = document.createElement('div');
      originalOption.className = 'version-option';
      originalOption.textContent = 'üìÑ Original Version';
      originalOption.addEventListener('click', () => {
        handleVersionSelection(action, filePath, exp, desc, idx, fileIdx, 'original');
        dropdown.remove();
      });
      
      const easyOption = document.createElement('div');
      easyOption.className = 'version-option';
      easyOption.textContent = '‚ú® Easy Version';
      easyOption.addEventListener('click', () => {
        // Convert to -v2 version
        const easyFilePath = filePath.replace('.html', '-v2.html');
        handleVersionSelection(action, easyFilePath, exp, desc, idx, fileIdx, 'easy');
        dropdown.remove();
      });
      
      dropdown.appendChild(originalOption);
      dropdown.appendChild(easyOption);
      
      // Position dropdown below button with mobile-friendly positioning
      const rect = button.getBoundingClientRect();
      dropdown.style.position = 'fixed';
      dropdown.style.top = (rect.bottom + 4) + 'px';
      
      // Calculate left position, ensuring dropdown doesn't overflow right edge
      const dropdownWidth = 160; // min-width from CSS
      const viewportWidth = window.innerWidth;
      let leftPos = rect.left;
      
      // If dropdown would overflow right edge, align it to the right instead
      if (leftPos + dropdownWidth > viewportWidth) {
        leftPos = Math.max(8, viewportWidth - dropdownWidth - 8);
      }
      
      dropdown.style.left = leftPos + 'px';
      
      document.body.appendChild(dropdown);
      
      // Close dropdown when clicking outside
      setTimeout(() => {
        const closeDropdown = (e) => {
          if (!dropdown.contains(e.target) && e.target !== button) {
            dropdown.remove();
            document.removeEventListener('click', closeDropdown);
          }
        };
        document.addEventListener('click', closeDropdown);
      }, 100);
    }
    
    function handleVersionSelection(action, filePath, exp, desc, idx, fileIdx, version) {
      localStorage.setItem('filePath', filePath);
      localStorage.setItem('experimentName', exp.name || `Experiment ${idx+1}`);
      localStorage.setItem('fileDescription', desc);
      
      if (action === 'code') {
        sendAnalyticsData(null, 'Code View', filePath);
        window.location.href = 'code.html';
      } else if (action === 'output') {
        const outputUrl = `https://nathanlobo.github.io/CodeStore/${filePath}`;
        sendAnalyticsData(null, 'Output', outputUrl);
        window.location.href = 'output.html';
      } else if (action === 'download') {
        const rawUrl = `https://raw.githubusercontent.com/${owner}/${repo}/${branch}/${encodeURIComponent(filePath).replace(/%2F/g, '/')}`;
        sendAnalyticsData(null, 'Download', filePath);
        downloadFile(rawUrl, filePath.split('/').pop());
      }
    }

    // Render experiment cards
    function renderExperiments(expts) {
      if (!Array.isArray(expts) || expts.length === 0) {
        container.innerHTML = '<p>No experiments defined.</p>';
        return;
      }
      container.innerHTML = '';
      expts.forEach((exp, idx) => {
        const block = document.createElement('div');
        block.className = 'link-block';

        const info = document.createElement('div');
        info.className = 'link-info';

        const title = document.createElement('div');
        title.className = 'link-title';
        title.textContent = exp.name || `Experiment ${idx+1}`;

        info.appendChild(title);

        // List files for this experiment
        if (Array.isArray(exp.files) && exp.files.length > 0) {
          exp.files.forEach((filePath, fileIdx) => {
            const fileDiv = document.createElement('div');
            fileDiv.className = 'file-row';

            // Use filedesc if available, else fallback to filePath
            const urlA = document.createElement('a');
            urlA.className = 'link-url';
            urlA.href = `https://github.com/${owner}/${repo}/blob/${branch}/${encodeURIComponent(filePath).replace(/%2F/g, '/')}`;
            let desc = (Array.isArray(exp.filedesc) && exp.filedesc[fileIdx]) ? exp.filedesc[fileIdx] : filePath;
            urlA.textContent = desc;
            urlA.target = '_blank';
            urlA.rel = 'noopener noreferrer';

            fileDiv.appendChild(urlA);

            // Button container for Code, Output, Download
            const btnContainer = document.createElement('div');
            btnContainer.className = 'button-container';
            btnContainer.style.gap = '4px';

            // Code button
            const codeBtn = document.createElement('button');
            codeBtn.className = 'btn btn-view';
            codeBtn.textContent = 'Code';
            
            // Check if this is Expt 7 HTML to show version selector
            const isExpt7HTML = localStorage.getItem('selectedTab') === 'HTML' && 
                                exp.name.includes('Expt 7');
            
            if (isExpt7HTML) {
              codeBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                showVersionSelector(e.target, 'code', filePath, exp, desc, idx);
              });
            } else {
              codeBtn.addEventListener('click', () => {
                localStorage.setItem('filePath', filePath);
                localStorage.setItem('experimentName', exp.name || `Experiment ${idx+1}`);
                localStorage.setItem('fileDescription', desc); // Store file description
                sendAnalyticsData(null, 'Code View', filePath);
                window.location.href = 'code.html';
              });
            }

              let showOutputBtn = true;
              // Hide Output button for 2nd and 3rd files of Expt 3 in PHP experiments
              if (localStorage.getItem('selectedTab') === 'PHP' && exp.name === 'Expt 2' && (fileIdx === 1 || fileIdx === 3 || fileIdx === 5)) { showOutputBtn = false; }
              if (localStorage.getItem('selectedTab') === 'PHP' && exp.name === 'Expt 3' && (fileIdx === 1 || fileIdx === 2)) { showOutputBtn = false; }
              if (localStorage.getItem('selectedTab') === 'PHP' && exp.name === 'Expt 9' && (fileIdx === 1)) { showOutputBtn = false; }
              if (localStorage.getItem('selectedTab') === 'HTML' && exp.name === 'Expt 4' && (fileIdx === 1)) { showOutputBtn = false; }
              if (localStorage.getItem('selectedTab') === 'HTML' && exp.name.includes('Expt 9') && (fileIdx === 1)) { showOutputBtn = false; }
              if (localStorage.getItem('selectedTab') === 'HTML' && exp.name.includes('Expt 11') && (fileIdx === 1 || fileIdx === 3)) { showOutputBtn = false; }
              if (showOutputBtn) {
                const outputBtn = document.createElement('button');
                outputBtn.className = 'btn btn-output';
                outputBtn.textContent = 'Output';
                if (localStorage.getItem('selectedTab') === 'DSC++') {
                  // DSC++ output button with validation logic
                  if (Array.isArray(exp.outputLinks) && exp.outputLinks[fileIdx]) {
                    outputBtn.addEventListener('click', async () => {
                      try {
                        localStorage.setItem('filePath', filePath);
                        localStorage.setItem('experimentName', exp.name || `Experiment ${idx+1}`);
                        localStorage.setItem('fileDescription', desc);
                        
                        // Step 1: Check for roll number
                        let rollNo = localStorage.getItem('rollNo');
                        
                        if (!rollNo) {
                          // Try to migrate userName to rollNo
                          rollNo = await checkAndMigrateUserName();
                        }
                        
                        if (!rollNo) {
                          // Show modal to get roll number
                          try {
                            rollNo = await showRollNoModal(exp.outputLinks[fileIdx], filePath, exp, desc);
                          } catch (error) {
                            console.log('User cancelled roll number input');
                            return;
                          }
                        }
                        
                        // Step 2: Redirect with roll number appended
                        const baseUrl = exp.outputLinks[fileIdx];
                        const finalUrl = `${baseUrl}/${rollNo}`;
                        
                        sendAnalyticsData(null, 'Output', finalUrl);
                        window.open(finalUrl, '_self');
                      } catch (error) {
                        console.error('Error processing output:', error);
                        alert('An error occurred. Please try again.');
                      }
                    });
                  } else {
                    // No output link defined, disable button
                    outputBtn.disabled = true;
                    outputBtn.style.opacity = '0.5';
                    outputBtn.title = 'Output not available';
                  }
                } else if (isExpt7HTML) {
                  outputBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    showVersionSelector(e.target, 'output', filePath, exp, desc, idx, fileIdx);
                  });
                } else if (Array.isArray(exp.outputLinks) && exp.outputLinks[fileIdx]) {
                  outputBtn.addEventListener('click', () => {
                    const outputUrl = exp.outputLinks[fileIdx];
                    localStorage.setItem('filePath', filePath);
                    localStorage.setItem('experimentName', exp.name || `Experiment ${idx+1}`);
                    localStorage.setItem('fileDescription', desc); // Store file description
                    sendAnalyticsData(null, 'Output', outputUrl);
                    window.open(outputUrl, '_blank');
                    // window.location.href = 'output.html';
                  });
                } else {
                  outputBtn.addEventListener('click', () => {
                    const outputUrl = `https://nathanlobo.github.io/CodeStore/${filePath}`;
                    localStorage.setItem('filePath', filePath);
                    localStorage.setItem('experimentName', exp.name || `Experiment ${idx+1}`);
                    localStorage.setItem('fileDescription', desc); // Store file description
                    sendAnalyticsData(null, 'Output', outputUrl);
                    window.location.href = 'output.html';
                    // window.open(outputUrl, '_blank');
                  });
                }
                btnContainer.appendChild(codeBtn);
                btnContainer.appendChild(outputBtn);
              } else {
                btnContainer.appendChild(codeBtn);
              }

            const rawUrl = `https://raw.githubusercontent.com/${owner}/${repo}/${branch}/${encodeURIComponent(filePath).replace(/%2F/g, '/')}`;
            const downloadBtn = document.createElement('button');
            downloadBtn.className = 'btn btn-download';
            downloadBtn.textContent = 'Download';

            // Check if this file should trigger a release zip download
            if (isExpt7HTML) {
              downloadBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                showVersionSelector(e.target, 'download', filePath, exp, desc, idx);
              });
            } else if (zipDownloads[filePath]) {
              const zipUrl = zipDownloads[filePath];
              downloadBtn.addEventListener('click', () => {
                // Track analytics for download button click
                sendAnalyticsData(null, 'Download', zipUrl);
                // Use the last part of the URL as filename
                const zipFileName = zipUrl.split('/').pop();
                downloadFile(zipUrl, zipFileName);
              });
            } else {
              downloadBtn.addEventListener('click', () => {
                // Track analytics for download button click
                sendAnalyticsData(null, 'Download', filePath);
                downloadFile(rawUrl, filePath.split('/').pop());
              });
            }

            btnContainer.appendChild(downloadBtn);
            fileDiv.appendChild(btnContainer);

            info.appendChild(fileDiv);
          });
        } else {
          const noFiles = document.createElement('div');
          noFiles.textContent = 'No files listed.';
          info.appendChild(noFiles);
        }

        block.appendChild(info);
        container.appendChild(block);
      });
    }

    // Tab switching logic with experiment filtering and persistence
    function activateTab(tabName, trackAnalytics = false) {
      document.querySelectorAll('.tab-btn').forEach(b => {
        if (b.dataset.tab === tabName) {
          b.classList.add('active');
        } else {
          b.classList.remove('active');
        }
      });
      localStorage.setItem('selectedTab', tabName);
      
      // Track tab switch in analytics if requested
      if (trackAnalytics) {
        sendAnalyticsData(null, 'Tab Switch', tabName);
      }
      
      if (tabName === 'HTML') {
        renderExperiments(htmlExpts);
      } else if (tabName === 'DSC++') {
        renderExperiments(dscppExpts);
      } else if (tabName === 'PHP') {
        renderExperiments(phpExpts);
      } else {
        activateTab('HTML');
        renderExperiments(htmlExpts);
      }
    }

    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        activateTab(this.dataset.tab, true); // Enable analytics tracking on manual tab clicks
      });
    });

    // Note: activateTab is now called after data.json is loaded (see fetch callback above)
    
    // Hide loading overlay after content is loaded
    window.addEventListener('load', function() {
      const loadingOverlay = document.getElementById('loadingOverlay');
      setTimeout(() => {
        loadingOverlay.classList.add('hidden');
        // Remove from DOM after fade out animation completes
        setTimeout(() => {
          loadingOverlay.style.display = 'none';
        }, 500);
      }, 300); // Small delay to ensure smooth transition
    });
  </script>

  <!-- (Removed bottom ad banner) -->

    </div><!-- End center-content -->
  </div><!-- End main-content-wrapper -->

  <!-- Footer Bar -->
  <footer class="footer-bar">
    <div class="footer-content">
      <p class="footer-title" id="footer-title">Contact for Queries</p>
      <div class="social-links">
        <a href="https://wa.me/+919689137817" class="social-icon" id="whatsapp" title="WhatsApp" target="_blank">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
          </svg>
        </a>
        <a href="https://instagram.com/nathanlobo.22" class="social-icon" id="instagram" title="Instagram" target="_blank">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M7.8 2h8.4C19.4 2 22 4.6 22 7.8v8.4a5.8 5.8 0 0 1-5.8 5.8H7.8C4.6 22 2 19.4 2 16.2V7.8A5.8 5.8 0 0 1 7.8 2m-.2 2A3.6 3.6 0 0 0 4 7.6v8.8C4 18.39 5.61 20 7.6 20h8.8a3.6 3.6 0 0 0 3.6-3.6V7.6C20 5.61 18.39 4 16.4 4H7.6m9.65 1.5a1.25 1.25 0 0 1 1.25 1.25A1.25 1.25 0 0 1 17.25 8 1.25 1.25 0 0 1 16 6.75a1.25 1.25 0 0 1 1.25-1.25M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3z"/>
          </svg>
        </a>
        <a href="mailto:lobonathan2209@gmail.com" class="social-icon" id="gmail" title="Gmail">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
          </svg>
        </a>
        <a href="https://github.com/nathanlobo" class="social-icon" id="github" title="GitHub" target="_blank">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2z"/>
          </svg>
        </a>
      </div>
      <p class="footer-text" id="footer-text">¬© 2026 Nathan Lobo. All rights reserved.</p>
      <div class="footer-links">
        <a href="https://www.codinx.app/fund-me" class="footer-link">Fund Us</a>
        <span class="footer-separator">|</span>
        <a href="about.html" class="footer-link">About</a>
        <span class="footer-separator">|</span>
        <a href="privacy-policy.html" class="footer-link">Privacy Policy</a>
      </div>
    </div>
  </footer>
</body>
</html>
